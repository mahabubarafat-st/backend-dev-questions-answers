<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog - Backend Developer Course</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <nav class="navbar">
        <a href="/" class="logo">BackendPro</a>
        
        <ul class="nav-links" id="nav-links">
          <li><a href="/">Home</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/pricing.html">Pricing</a></li>
          <li><a href="/blog.html" class="active">Blog</a></li>
          <li><a href="/contact.html">Contact</a></li>
          <li id="auth-nav">
            <a href="/login.html" class="btn btn-sm">Login</a>
          </li>
          <li id="user-nav" class="hidden">
            <a href="/dashboard.html">Dashboard</a>
          </li>
          <li id="admin-link" class="hidden">
            <a href="/admin.html">Admin</a>
          </li>
          <li id="user-nav" class="hidden">
            <a href="#" id="logout-btn">Logout</a>
          </li>
        </ul>
        
        <div class="mobile-menu" id="mobile-menu-btn">
          <i class="fas fa-bars"></i>
        </div>
      </nav>
    </div>
  </header>

  <!-- Blog Hero Section -->
  <section class="hero" style="padding: 8rem 0 3rem;">
    <div class="container">
      <h1>Backend Developer Blog</h1>
      <p>Articles, tutorials, and insights on backend development</p>
    </div>
  </section>

  <!-- Blog Content -->
  <section class="py-5" style="background-color: white;">
    <div class="container">
      <div class="blog-filters mb-4">
        <div class="row">
          <div class="col">
            <select id="category-filter" class="form-control">
              <option value="">All Categories</option>
              <option value="announcement">Announcements</option>
              <option value="tutorial">Tutorials</option>
              <option value="news">News</option>
              <option value="discussion">Discussions</option>
            </select>
          </div>
          <div class="col">
            <input type="text" id="search-filter" class="form-control" placeholder="Search posts...">
          </div>
        </div>
      </div>
      
      <div id="blog-posts" class="blog-grid">
        <div class="text-center py-4">
          <i class="fas fa-spinner fa-spin fa-2x"></i>
          <p>Loading posts...</p>
        </div>
      </div>
      
      <div id="pagination" class="text-center mt-4">
        <!-- Pagination will be added here -->
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta">
    <div class="container">
      <h2>Ready to Ace Your Next Backend Interview?</h2>
      <p>Join thousands of developers who have used our course to prepare for technical interviews and advance their careers.</p>
      <a href="/register.html" class="btn btn-lg">Get Started Now</a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-column">
          <h3>BackendPro</h3>
          <p>Comprehensive backend developer interview preparation course.</p>
        </div>
        
        <div class="footer-column">
          <h3>Quick Links</h3>
          <ul class="footer-links">
            <li><a href="/">Home</a></li>
            <li><a href="/about.html">About</a></li>
            <li><a href="/pricing.html">Pricing</a></li>
            <li><a href="/blog.html">Blog</a></li>
            <li><a href="/contact.html">Contact</a></li>
          </ul>
        </div>
        
        <div class="footer-column">
          <h3>Resources</h3>
          <ul class="footer-links">
            <li><a href="/faq.html">FAQ</a></li>
            <li><a href="/terms.html">Terms of Service</a></li>
            <li><a href="/privacy.html">Privacy Policy</a></li>
          </ul>
        </div>
        
        <div class="footer-column">
          <h3>Connect With Us</h3>
          <div class="social-links">
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-linkedin"></i></a>
            <a href="#"><i class="fab fa-github"></i></a>
          </div>
        </div>
      </div>
      
      <div class="footer-bottom">
        <p>&copy; 2025 BackendPro. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="/js/main.js"></script>
  <script>
    // Blog functionality
    document.addEventListener('DOMContentLoaded', () => {
      loadBlogPosts();
      
      // Set up filters
      document.getElementById('category-filter').addEventListener('change', loadBlogPosts);
      
      // Set up search with debounce
      const searchInput = document.getElementById('search-filter');
      let debounceTimer;
      searchInput.addEventListener('input', () => {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => {
          loadBlogPosts();
        }, 500);
      });
    });
    
    async function loadBlogPosts(page = 1) {
      try {
        const blogPostsContainer = document.getElementById('blog-posts');
        blogPostsContainer.innerHTML = `
          <div class="text-center py-4">
            <i class="fas fa-spinner fa-spin fa-2x"></i>
            <p>Loading posts...</p>
          </div>
        `;
        
        // Get filter values
        const category = document.getElementById('category-filter').value;
        const search = document.getElementById('search-filter').value;
        
        // Build query string
        let queryString = `?page=${page}&limit=6`;
        if (category) queryString += `&category=${category}`;
        if (search) queryString += `&search=${encodeURIComponent(search)}`;
        
        // Fetch posts
        const response = await fetch(`/api/posts${queryString}`);
        const data = await response.json();
        
        if (data.posts.length === 0) {
          blogPostsContainer.innerHTML = `
            <div class="text-center py-4">
              <i class="fas fa-newspaper fa-3x mb-3" style="color: #ccc;"></i>
              <h3>No Posts Found</h3>
              <p>There are no posts matching your criteria.</p>
            </div>
          `;
          document.getElementById('pagination').innerHTML = '';
          return;
        }
        
        // Render posts
        blogPostsContainer.innerHTML = '';
        data.posts.forEach(post => {
          const postElement = document.createElement('div');
          postElement.className = 'blog-card';
          
          const categoryBadge = getCategoryBadge(post.category);
          const excerpt = post.content.length > 150 ? post.content.substring(0, 150) + '...' : post.content;
          
          postElement.innerHTML = `
            ${post.featuredImage ? `<div class="blog-image">
              <img src="${post.featuredImage}" alt="${post.title}">
            </div>` : ''}
            <div class="blog-content">
              <div class="blog-meta">
                <span class="blog-category ${categoryBadge.class}">${categoryBadge.text}</span>
                <span class="blog-date">${new Date(post.createdAt).toLocaleDateString()}</span>
              </div>
              <h3 class="blog-title">${post.title}</h3>
              <p class="blog-excerpt">${excerpt}</p>
              <div class="blog-footer">
                <a href="/blog/${post.slug}" class="btn btn-sm">Read More</a>
                <span class="blog-views"><i class="fas fa-eye"></i> ${post.viewCount}</span>
              </div>
            </div>
          `;
          
          blogPostsContainer.appendChild(postElement);
        });
        
        // Render pagination
        renderPagination(data.currentPage, data.totalPages);
      } catch (error) {
        console.error('Error loading blog posts:', error);
        document.getElementById('blog-posts').innerHTML = `
          <div class="text-center py-4">
            <i class="fas fa-exclamation-circle fa-3x mb-3" style="color: #e74c3c;"></i>
            <h3>Error Loading Posts</h3>
            <p>There was a problem loading the blog posts. Please try again later.</p>
          </div>
        `;
      }
    }
    
    function renderPagination(currentPage, totalPages) {
      const paginationContainer = document.getElementById('pagination');
      
      if (totalPages <= 1) {
        paginationContainer.innerHTML = '';
        return;
      }
      
      let paginationHTML = '<div class="pagination">';
      
      // Previous button
      if (currentPage > 1) {
        paginationHTML += `<a href="#" onclick="loadBlogPosts(${currentPage - 1}); return false;" class="pagination-item">&laquo; Previous</a>`;
      } else {
        paginationHTML += `<span class="pagination-item disabled">&laquo; Previous</span>`;
      }
      
      // Page numbers
      const startPage = Math.max(1, currentPage - 2);
      const endPage = Math.min(totalPages, currentPage + 2);
      
      if (startPage > 1) {
        paginationHTML += `<a href="#" onclick="loadBlogPosts(1); return false;" class="pagination-item">1</a>`;
        if (startPage > 2) {
          paginationHTML += `<span class="pagination-item">...</span>`;
        }
      }
      
      for (let i = startPage; i <= endPage; i++) {
        if (i === currentPage) {
          paginationHTML += `<span class="pagination-item active">${i}</span>`;
        } else {
          paginationHTML += `<a href="#" onclick="loadBlogPosts(${i}); return false;" class="pagination-item">${i}</a>`;
        }
      }
      
      if (endPage < totalPages) {
        if (endPage < totalPages - 1) {
          paginationHTML += `<span class="pagination-item">...</span>`;
        }
        paginationHTML += `<a href="#" onclick="loadBlogPosts(${totalPages}); return false;" class="pagination-item">${totalPages}</a>`;
      }
      
      // Next button
      if (currentPage < totalPages) {
        paginationHTML += `<a href="#" onclick="loadBlogPosts(${currentPage + 1}); return false;" class="pagination-item">Next &raquo;</a>`;
      } else {
        paginationHTML += `<span class="pagination-item disabled">Next &raquo;</span>`;
      }
      
      paginationHTML += '</div>';
      paginationContainer.innerHTML = paginationHTML;
    }
    
    function getCategoryBadge(category) {
      switch (category) {
        case 'announcement':
          return { class: 'badge-primary', text: 'Announcement' };
        case 'tutorial':
          return { class: 'badge-success', text: 'Tutorial' };
        case 'news':
          return { class: 'badge-info', text: 'News' };
        case 'discussion':
          return { class: 'badge-warning', text: 'Discussion' };
        default:
          return { class: 'badge-secondary', text: 'Other' };
      }
    }
  </script>
</body>
</html>